print(sqrt(mean((noisy.y - y)^2)))
} else {
perf <- sapply(power, function(pow){summary(lm(noisy.y ~ poly(q,pow)))$r.squared })
print(data.frame(hyper_parameter = power, performance = signif(perf, 3)))
}
}
get_poly_model(error = 40, ML = T)
20^4
20^4 * 10
signif(20^4 * 10, 2)
signif(20^4 * 10)
signif(20^4 * 10) / 1E6
library("mlr")
lrn <- makeLearner("classif.h2o.deeplearning")
install.packages("h2o")
lrn <- makeLearner("classif.h2o.deeplearning")
getParamSet(lrn)
library("mlr")
getParamSet(makeLearner("classif.h2o.deeplearning"))
setwd("/media/hguillon/hrvg/research/exploitation/R/latin_america")
theme_df_docs <- readRDS("data/theme_df_docs.Rds")
dim(theme_df_docs)
topicDocs <- readRDS("./data/topicDocs.Rds")
dim(topicDocs)
theme_df_docs_bak <- theme_df_docs
make_df_docs <- function(theme_type){
topicDocs <- readRDS("./data/topicDocs.Rds")
topic_names <- read.csv("./data/topic_names.csv")
topic_names <- topic_names[match(seq(nrow(topic_names)), topic_names$topic_id), ]
topicDocs <- as.data.frame(topicDocs)
colnames(topicDocs) <- topic_names$topic_name
theme_type <- "theme"
themes <- unique(topic_names[[theme_type]][!is.na(topic_names[[theme_type]])])
theme_df_docs <- lapply(themes, function(th){
ind <- which(topic_names[[theme_type]] == th)
if (length(ind) == 1){
return(topicDocs[, ind])
} else {
return(rowSums(topicDocs[, ind]))
}
})
theme_df_docs <- do.call(cbind, theme_df_docs)
rownames(theme_df_docs) <- rownames(topicDocs)
colnames(theme_df_docs) <- themes
rm(topicDocs)
rSums <- rowSums(theme_df_docs)
theme_df_docs <- sweep(theme_df_docs, 1, rSums, "/")
saveRDS(object = theme_df_docs, paste0("./data/", theme_type, "_df_docs.Rds"))
}
make_df_docs(theme_type = "theme")
theme_df_docs <- readRDS("data/theme_df_docs.Rds")
identical(theme_df_docs, theme_df_docs_bak)
make_df_docs(theme_type = "NSF_general")
make_df_docs <- function(theme_type){
topicDocs <- readRDS("./data/topicDocs.Rds")
topic_names <- read.csv("./data/topic_names.csv")
topic_names <- topic_names[match(seq(nrow(topic_names)), topic_names$topic_id), ]
topicDocs <- as.data.frame(topicDocs)
colnames(topicDocs) <- topic_names$topic_name
themes <- unique(topic_names[[theme_type]][!is.na(topic_names[[theme_type]])])
theme_df_docs <- lapply(themes, function(th){
ind <- which(topic_names[[theme_type]] == th)
if (length(ind) == 1){
return(topicDocs[, ind])
} else {
return(rowSums(topicDocs[, ind]))
}
})
theme_df_docs <- do.call(cbind, theme_df_docs)
rownames(theme_df_docs) <- rownames(topicDocs)
colnames(theme_df_docs) <- themes
rm(topicDocs)
rSums <- rowSums(theme_df_docs)
theme_df_docs <- sweep(theme_df_docs, 1, rSums, "/")
saveRDS(object = theme_df_docs, paste0("./data/", theme_type, "_df_docs.Rds"))
}
make_df_docs(theme_type = "NSF_general")
theme_df_docs <- readRDS("data/NSF_general_df_docs.Rds")
dim(theme_df_docs)
head(theme_df_ddocs)
head(theme_df_docs)
rowSums(theme_df_docs)
all(rowSums(theme_df_docs) == 1)
all(rowSums(theme_df_docs) >= 1-1E16)
all(rowSums(theme_df_docs) >= 1-1E17)
all(rowSums(theme_df_docs) >= 1-1E22)
all(rowSums(theme_df_docs) >= 1-1E36)
all(rowSums(theme_df_docs) >= 1-1E50)
all(rowSums(theme_df_docs) >= 1-1E49)
topic_names <- read.csv("./data/topic_names.csv")
topic_names$description
topic_names$description[[1]]
as.character(topic_names$description)
topic_names <- read.csv("./data/topic_names.csv")
topic_names$description <- as.character(topic_names$description)
topic_names$description <- gsub("", NA, topic_names$description)
topic_names$description
topic_names <- read.csv("./data/topic_names.csv")
topic_names$description <- as.character(topic_names$description)
topic_names$description[1]
make_df_docs <- function(theme_type = "theme", description = NULL){
topicDocs <- readRDS("./data/topicDocs.Rds")
topic_names <- read.csv("./data/topic_names.csv")
topic_names$description <- as.character(topic_names$description)
topic_names <- topic_names[match(seq(nrow(topic_names)), topic_names$topic_id), ]
topicDocs <- as.data.frame(topicDocs)
colnames(topicDocs) <- topic_names$topic_name
if (!is.null(description)){
theme_type <- "topic_name"
themes <- unique(topic_names[[theme_type]][grepl(description, topic_names$description)])
} else {
themes <- unique(topic_names[[theme_type]][!is.na(topic_names[[theme_type]])])
}
theme_df_docs <- lapply(themes, function(th){
ind <- which(topic_names[[theme_type]] == th)
if (length(ind) == 1){
return(topicDocs[, ind])
} else {
return(rowSums(topicDocs[, ind]))
}
})
theme_df_docs <- do.call(cbind, theme_df_docs)
rownames(theme_df_docs) <- rownames(topicDocs)
colnames(theme_df_docs) <- themes
rm(topicDocs)
rSums <- rowSums(theme_df_docs)
theme_df_docs <- sweep(theme_df_docs, 1, rSums, "/")
saveRDS(object = theme_df_docs, paste0("./data/", ifelse(is.null(description), theme_type, description), "_df_docs.Rds"))
}
make_df_docs(description = "methods")
theme_df_docs <- readRDS("./data/methods_df_docs.Rds")
head(theme_df_docs)
make_df_docs <- function(theme_type = "theme", description = NULL){
stopifnot(theme_type %in% c("topic_name", "theme", "NSF_specific", "NSF_general"))
if (!is.null(description)){
stopifnot(description %in% c("spatial scale", "methods", "temporal scale", "water budget"))
}
topicDocs <- readRDS("./data/topicDocs.Rds")
topic_names <- read.csv("./data/topic_names.csv")
topic_names$description <- as.character(topic_names$description)
topic_names <- topic_names[match(seq(nrow(topic_names)), topic_names$topic_id), ]
topicDocs <- as.data.frame(topicDocs)
colnames(topicDocs) <- topic_names$topic_name
if (!is.null(description)){
theme_type <- "topic_name"
themes <- unique(topic_names[[theme_type]][grepl(description, topic_names$description)])
} else {
themes <- unique(topic_names[[theme_type]][!is.na(topic_names[[theme_type]])])
}
theme_df_docs <- lapply(themes, function(th){
ind <- which(topic_names[[theme_type]] == th)
if (length(ind) == 1){
return(topicDocs[, ind])
} else {
return(rowSums(topicDocs[, ind]))
}
})
theme_df_docs <- do.call(cbind, theme_df_docs)
rownames(theme_df_docs) <- rownames(topicDocs)
colnames(theme_df_docs) <- themes
rm(topicDocs)
rSums <- rowSums(theme_df_docs)
theme_df_docs <- sweep(theme_df_docs, 1, rSums, "/")
saveRDS(object = theme_df_docs, paste0("./data/", ifelse(is.null(description), theme_type, description), "_df_docs.Rds"))
}
make_df_docs(theme_type = "pasta")
make_df_docs(theme_type = "theme", description = "pasta")
make_df_docs <- function(theme_type = "theme", description = NULL, save = FALSE){
stopifnot(theme_type %in% c("topic_name", "theme", "NSF_specific", "NSF_general"))
if (!is.null(description)){
stopifnot(description %in% c("spatial scale", "methods", "temporal scale", "water budget"))
}
topicDocs <- readRDS("./data/topicDocs.Rds")
topic_names <- read.csv("./data/topic_names.csv")
topic_names$description <- as.character(topic_names$description)
topic_names <- topic_names[match(seq(nrow(topic_names)), topic_names$topic_id), ]
topicDocs <- as.data.frame(topicDocs)
colnames(topicDocs) <- topic_names$topic_name
if (!is.null(description)){
theme_type <- "topic_name"
themes <- unique(topic_names[[theme_type]][grepl(description, topic_names$description)])
} else {
themes <- unique(topic_names[[theme_type]][!is.na(topic_names[[theme_type]])])
}
theme_df_docs <- lapply(themes, function(th){
ind <- which(topic_names[[theme_type]] == th)
if (length(ind) == 1){
return(topicDocs[, ind])
} else {
return(rowSums(topicDocs[, ind]))
}
})
theme_df_docs <- do.call(cbind, theme_df_docs)
rownames(theme_df_docs) <- rownames(topicDocs)
colnames(theme_df_docs) <- themes
rm(topicDocs)
rSums <- rowSums(theme_df_docs)
theme_df_docs <- sweep(theme_df_docs, 1, rSums, "/")
if (save){
saveRDS(object = theme_df_docs, paste0("./data/", ifelse(is.null(description), theme_type, description), "_df_docs.Rds"))
} else {
return(theme_df_docs)
}
}
v
consolidate_LDA_results <- function(theme_type = "theme", description = NULL, save = TRUE){
theme_df_docs <- make_df_docs(theme_type = theme_type, description = description)
theme_df_docs <- readRDS(paste0("data/", theme_type, "_df_docs.Rds"))
in_corpus_file <- "in_corpus.Rds"
in_corpus <- readRDS(in_corpus_file)
EndNoteIdcorpus <- unname(sapply(in_corpus$pdfs, substr, start = 1, stop = 10))
EndNoteIdLDA <- unname(sapply(titleDocs, substr, start = 1, stop = 10))
in_corpus_LDA <- in_corpus[which(EndNoteIdcorpus %in% EndNoteIdLDA), ]
missing <- which(! EndNoteIdLDA %in% EndNoteIdcorpus)
theme_df_docs <- theme_df_docs[-missing, ]
consolidated_results <- data.frame(year = year, country = as.character(predCountry))
consolidated_results <- cbind(theme_df_docs, consolidated_results)
if (save){
saveRDS(consolidated_results, paste0("consolidated_results_", theme_type, ".Rds"))
} else {
return(consolidated_results)
}
}
save_predCountryMembership <- function(predCountryMembership){
in_corpus_file <- "in_corpus.Rds"
in_corpus <- readRDS(in_corpus_file)
EndNoteIdcorpus <- unname(sapply(in_corpus$pdfs, substr, start = 1, stop = 10))
EndNoteIdLDA <- unname(sapply(titleDocs, substr, start = 1, stop = 10))
in_corpus_LDA <- in_corpus[which(EndNoteIdcorpus %in% EndNoteIdLDA), ]
missing <- which(! EndNoteIdLDA %in% EndNoteIdcorpus)
year <- in_corpus_LDA$Year
predCountry <- predCountry[-missing]
predCountryMembership <- totPred$data[-missing, colnames(predCountryMembership) != "response"]
saveRDS(predCountryMembership, "predCountryMembership.Rds")
}
make_df_docs <- function(theme_type = "theme", description = NULL, save = FALSE){
stopifnot(theme_type %in% c("topic_name", "theme", "NSF_specific", "NSF_general"))
if (!is.null(description)){
stopifnot(description %in% c("spatial scale", "methods", "temporal scale", "water budget"))
}
topicDocs <- readRDS("./data/topicDocs.Rds")
topic_names <- read.csv("./data/topic_names.csv")
topic_names$description <- as.character(topic_names$description)
topic_names <- topic_names[match(seq(nrow(topic_names)), topic_names$topic_id), ]
topicDocs <- as.data.frame(topicDocs)
colnames(topicDocs) <- topic_names$topic_name
if (!is.null(description)){
theme_type <- "topic_name"
themes <- unique(topic_names[[theme_type]][grepl(description, topic_names$description)])
} else {
themes <- unique(topic_names[[theme_type]][!is.na(topic_names[[theme_type]])])
}
theme_df_docs <- lapply(themes, function(th){
ind <- which(topic_names[[theme_type]] == th)
if (length(ind) == 1){
return(topicDocs[, ind])
} else {
return(rowSums(topicDocs[, ind]))
}
})
theme_df_docs <- do.call(cbind, theme_df_docs)
rownames(theme_df_docs) <- rownames(topicDocs)
colnames(theme_df_docs) <- themes
rm(topicDocs)
rSums <- rowSums(theme_df_docs)
theme_df_docs <- sweep(theme_df_docs, 1, rSums, "/")
if (save){
saveRDS(object = theme_df_docs, paste0("./data/", ifelse(is.null(description), theme_type, description), "_df_docs.Rds"))
} else {
return(theme_df_docs)
}
}
predCountryMembership <- readRDS("predCountryMembership.Rds")
predCountryMembership
dim(predCountryMembership)
predCountry <- colnames(predCountry)[apply(predCountryMembership, 1, which.max)]
predCountry <- colnames(predCountryMembership)[apply(predCountryMembership, 1, which.max)]
predCountry
predCountry <- gsub("prob.", "", predCountry)
head(predCountry)
consolidate_LDA_results <- function(theme_type = "theme", description = NULL, save = TRUE){
theme_df_docs <- make_df_docs(theme_type = theme_type, description = description)
in_corpus_file <- "in_corpus.Rds"
in_corpus <- readRDS(in_corpus_file)
EndNoteIdcorpus <- unname(sapply(in_corpus$pdfs, substr, start = 1, stop = 10))
EndNoteIdLDA <- unname(sapply(titleDocs, substr, start = 1, stop = 10))
in_corpus_LDA <- in_corpus[which(EndNoteIdcorpus %in% EndNoteIdLDA), ]
missing <- which(! EndNoteIdLDA %in% EndNoteIdcorpus)
theme_df_docs <- theme_df_docs[-missing, ]
consolidated_results <- data.frame(year = year, country = as.character(predCountry))
consolidated_results <- cbind(theme_df_docs, consolidated_results)
if (save){
saveRDS(consolidated_results, paste0("consolidated_results_", theme_type, ".Rds"))
} else {
return(consolidated_results)
}
}
get_predCountry <- function(){
predCountryMembership <- readRDS("predCountryMembership.Rds")
predCountry <- colnames(predCountryMembership)[apply(predCountryMembership, 1, which.max)]
predCountry <- gsub("prob.", "", predCountry)
}
save_predCountryMembership <- function(predCountryMembership){
in_corpus_file <- "in_corpus.Rds"
in_corpus <- readRDS(in_corpus_file)
EndNoteIdcorpus <- unname(sapply(in_corpus$pdfs, substr, start = 1, stop = 10))
EndNoteIdLDA <- unname(sapply(titleDocs, substr, start = 1, stop = 10))
in_corpus_LDA <- in_corpus[which(EndNoteIdcorpus %in% EndNoteIdLDA), ]
missing <- which(! EndNoteIdLDA %in% EndNoteIdcorpus)
year <- in_corpus_LDA$Year
predCountry <- predCountry[-missing]
predCountryMembership <- totPred$data[-missing, colnames(predCountryMembership) != "response"]
saveRDS(predCountryMembership, "predCountryMembership.Rds")
}
make_df_docs <- function(theme_type = "theme", description = NULL, save = FALSE){
stopifnot(theme_type %in% c("topic_name", "theme", "NSF_specific", "NSF_general"))
if (!is.null(description)){
stopifnot(description %in% c("spatial scale", "methods", "temporal scale", "water budget"))
}
topicDocs <- readRDS("./data/topicDocs.Rds")
topic_names <- read.csv("./data/topic_names.csv")
topic_names$description <- as.character(topic_names$description)
topic_names <- topic_names[match(seq(nrow(topic_names)), topic_names$topic_id), ]
topicDocs <- as.data.frame(topicDocs)
colnames(topicDocs) <- topic_names$topic_name
if (!is.null(description)){
theme_type <- "topic_name"
themes <- unique(topic_names[[theme_type]][grepl(description, topic_names$description)])
} else {
themes <- unique(topic_names[[theme_type]][!is.na(topic_names[[theme_type]])])
}
theme_df_docs <- lapply(themes, function(th){
ind <- which(topic_names[[theme_type]] == th)
if (length(ind) == 1){
return(topicDocs[, ind])
} else {
return(rowSums(topicDocs[, ind]))
}
})
theme_df_docs <- do.call(cbind, theme_df_docs)
rownames(theme_df_docs) <- rownames(topicDocs)
colnames(theme_df_docs) <- themes
rm(topicDocs)
rSums <- rowSums(theme_df_docs)
theme_df_docs <- sweep(theme_df_docs, 1, rSums, "/")
if (save){
saveRDS(object = theme_df_docs, paste0("./data/", ifelse(is.null(description), theme_type, description), "_df_docs.Rds"))
} else {
return(theme_df_docs)
}
}
predCountry <- get_predCountry()
predCountry
dim(predCountry)
length(predCountry)
dim(theme_df_docs)
consolidate_LDA_results <- function(theme_type = "theme", description = NULL, save = FALSE){
theme_df_docs <- make_df_docs(theme_type = theme_type, description = description)
in_corpus_file <- "in_corpus.Rds"
in_corpus <- readRDS(in_corpus_file)
EndNoteIdcorpus <- unname(sapply(in_corpus$pdfs, substr, start = 1, stop = 10))
EndNoteIdLDA <- unname(sapply(titleDocs, substr, start = 1, stop = 10))
in_corpus_LDA <- in_corpus[which(EndNoteIdcorpus %in% EndNoteIdLDA), ]
missing <- which(! EndNoteIdLDA %in% EndNoteIdcorpus)
theme_df_docs <- theme_df_docs[-missing, ]
consolidated_results <- data.frame(year = year, country = as.character(predCountry))
consolidated_results <- cbind(theme_df_docs, consolidated_results)
if (save){
saveRDS(consolidated_results, paste0("consolidated_results_", theme_type, ".Rds"))
} else {
return(consolidated_results)
}
}
consolidate_LDA_results(theme_type = "topics")
consolidate_LDA_results(theme_type = "topic_name")
consolidate_LDA_results <- function(theme_type = "theme", description = NULL, save = FALSE){
theme_df_docs <- make_df_docs(theme_type = theme_type, description = description)
in_corpus_file <- "in_corpus.Rds"
in_corpus <- readRDS(in_corpus_file)
EndNoteIdcorpus <- unname(sapply(in_corpus$pdfs, substr, start = 1, stop = 10))
titleDocs <- readLines("F:/hguillon/research/exploitation/R/latin_america/data/info.dat")
EndNoteIdLDA <- unname(sapply(titleDocs, substr, start = 1, stop = 10))
in_corpus_LDA <- in_corpus[which(EndNoteIdcorpus %in% EndNoteIdLDA), ]
missing <- which(! EndNoteIdLDA %in% EndNoteIdcorpus)
theme_df_docs <- theme_df_docs[-missing, ]
consolidated_results <- data.frame(year = year, country = as.character(predCountry))
consolidated_results <- cbind(theme_df_docs, consolidated_results)
if (save){
saveRDS(consolidated_results, paste0("consolidated_results_", theme_type, ".Rds"))
} else {
return(consolidated_results)
}
}
consolidate_LDA_results(theme_type = "topic_name")
titleDocs <- readLines("data/info.dat")
consolidate_LDA_results <- function(theme_type = "theme", description = NULL, save = FALSE){
theme_df_docs <- make_df_docs(theme_type = theme_type, description = description)
in_corpus_file <- "in_corpus.Rds"
in_corpus <- readRDS(in_corpus_file)
EndNoteIdcorpus <- unname(sapply(in_corpus$pdfs, substr, start = 1, stop = 10))
titleDocs <- readLines("data/info.dat")
EndNoteIdLDA <- unname(sapply(titleDocs, substr, start = 1, stop = 10))
in_corpus_LDA <- in_corpus[which(EndNoteIdcorpus %in% EndNoteIdLDA), ]
missing <- which(! EndNoteIdLDA %in% EndNoteIdcorpus)
theme_df_docs <- theme_df_docs[-missing, ]
consolidated_results <- data.frame(year = year, country = as.character(predCountry))
consolidated_results <- cbind(theme_df_docs, consolidated_results)
if (save){
saveRDS(consolidated_results, paste0("consolidated_results_", theme_type, ".Rds"))
} else {
return(consolidated_results)
}
}
consolidate_LDA_results(theme_type = "topic_name")
consolidate_LDA_results <- function(theme_type = "theme", description = NULL, save = FALSE){
theme_df_docs <- make_df_docs(theme_type = theme_type, description = description)
in_corpus_file <- "in_corpus.Rds"
in_corpus <- readRDS(in_corpus_file)
EndNoteIdcorpus <- unname(sapply(in_corpus$pdfs, substr, start = 1, stop = 10))
titleDocs <- readLines("data/info.dat")
EndNoteIdLDA <- unname(sapply(titleDocs, substr, start = 1, stop = 10))
in_corpus_LDA <- in_corpus[which(EndNoteIdcorpus %in% EndNoteIdLDA), ]
missing <- which(! EndNoteIdLDA %in% EndNoteIdcorpus)
theme_df_docs <- theme_df_docs[-missing, ]
year <- in_corpus_LDA$Year
consolidated_results <- data.frame(year = year, country = as.character(predCountry))
consolidated_results <- cbind(theme_df_docs, consolidated_results)
if (save){
saveRDS(consolidated_results, paste0("consolidated_results_", theme_type, ".Rds"))
} else {
return(consolidated_results)
}
}
head(consolidate_LDA_results(theme_type = "topic_name"))
head(consolidate_LDA_results(theme_type = "NSF_general"))
head(consolidate_LDA_results(theme_type = "NSF_specific"))
head(consolidate_LDA_results(theme_type = "NSF_specific", description = "methods"))
head(consolidate_LDA_results(theme_type = "NSF_specific", description = "spatial scale"))
head(consolidate_LDA_results(theme_type = "NSF_specific", description = "temporal scale"))
head(consolidate_LDA_results(theme_type = "NSF_specific", description = "temporal scale"))
make_df_docs <- function(theme_type = "theme", description = NULL, save = FALSE){
stopifnot(theme_type %in% c("topic_name", "theme", "NSF_specific", "NSF_general"))
if (!is.null(description)){
stopifnot(description %in% c("spatial scale", "methods", "water budget"))
}
topicDocs <- readRDS("./data/topicDocs.Rds")
topic_names <- read.csv("./data/topic_names.csv")
topic_names$description <- as.character(topic_names$description)
topic_names <- topic_names[match(seq(nrow(topic_names)), topic_names$topic_id), ]
topicDocs <- as.data.frame(topicDocs)
colnames(topicDocs) <- topic_names$topic_name
if (!is.null(description)){
theme_type <- "topic_name"
themes <- unique(topic_names[[theme_type]][grepl(description, topic_names$description)])
} else {
themes <- unique(topic_names[[theme_type]][!is.na(topic_names[[theme_type]])])
}
theme_df_docs <- lapply(themes, function(th){
ind <- which(topic_names[[theme_type]] == th)
if (length(ind) == 1){
return(topicDocs[, ind])
} else {
return(rowSums(topicDocs[, ind]))
}
})
theme_df_docs <- do.call(cbind, theme_df_docs)
rownames(theme_df_docs) <- rownames(topicDocs)
colnames(theme_df_docs) <- themes
rm(topicDocs)
rSums <- rowSums(theme_df_docs)
theme_df_docs <- sweep(theme_df_docs, 1, rSums, "/")
if (save){
saveRDS(object = theme_df_docs, paste0("./data/", ifelse(is.null(description), theme_type, description), "_df_docs.Rds"))
} else {
return(theme_df_docs)
}
}
head(consolidate_LDA_results(theme_type = "NSF_specific", description = "temporal scale"))
head(consolidate_LDA_results(theme_type = "NSF_specific", description = "spatial scale"))
head(consolidate_LDA_results(theme_type = "NSF_specific", description = "water budget"))
head(consolidate_LDA_results(theme_type = "NSF_specific", description = "methods"))
consolidate_LDA_results(theme_type = "theme", save = TRUE)
consolidate_LDA_results(theme_type = "NSF_general", save = TRUE)
consolidate_LDA_results(theme_type = "NSF_specific", save = TRUE)
consolidate_LDA_results(theme_type = "theme", description = "water budget", save = TRUE)
consolidate_LDA_results(theme_type = "theme", description = "methods", save = TRUE)
consolidate_LDA_results(theme_type = "theme", description = "spatial scale", save = TRUE)
consolidate_LDA_results <- function(theme_type = "theme", description = NULL, save = FALSE){
theme_df_docs <- make_df_docs(theme_type = theme_type, description = description)
in_corpus_file <- "in_corpus.Rds"
in_corpus <- readRDS(in_corpus_file)
EndNoteIdcorpus <- unname(sapply(in_corpus$pdfs, substr, start = 1, stop = 10))
titleDocs <- readLines("data/info.dat")
EndNoteIdLDA <- unname(sapply(titleDocs, substr, start = 1, stop = 10))
in_corpus_LDA <- in_corpus[which(EndNoteIdcorpus %in% EndNoteIdLDA), ]
missing <- which(! EndNoteIdLDA %in% EndNoteIdcorpus)
theme_df_docs <- theme_df_docs[-missing, ]
year <- in_corpus_LDA$Year
consolidated_results <- data.frame(year = year, country = as.character(predCountry))
consolidated_results <- cbind(theme_df_docs, consolidated_results)
if (save){
saveRDS(consolidated_results, paste0("consolidated_results_", ifelse(is.null(description), theme_type, description), ".Rds"))
} else {
return(consolidated_results)
}
}
consolidate_LDA_results(theme_type = "theme", save = TRUE)
consolidate_LDA_results(theme_type = "NSF_general", save = TRUE)
consolidate_LDA_results(theme_type = "NSF_specific", save = TRUE)
consolidate_LDA_results(theme_type = "theme", description = "water budget", save = TRUE)
consolidate_LDA_results(theme_type = "theme", description = "methods", save = TRUE)
consolidate_LDA_results(theme_type = "theme", description = "spatial scale", save = TRUE)
