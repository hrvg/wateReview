urlScopus <- in_scopus[1]
webpageScopus <- read_html(urlScopus)
webpageScopus <- read_html(as.character(urlScopus))
urlScopus
html_nodes(webpageScopus, "p:first-of-type")
html_nodes(webpageScopus, "abstractSection")
html_node(webpageScopus, "abstractSection")
html_nodes(webpageScopus, "abstract")
html_nodes(webpageScopus, "div")
html_nodes(webpageScopus, "contentWrapper")
html_node(webpageScopus, "contentWrapper")
html_nodes(webpageScopus, ".contentWrapper")
html_nodes(webpageScopus, ".profileleftinside")
html_nodes(webpageScopus, "profileleftinside")
html_nodes(webpageScopus, "h1.")
html_nodes(webpageScopus, "h1")
html_nodes(webpageScopus, "h3")
html_nodes(webpageScopus, "row")
html_nodes(webpageScopus, ".row")
html_nodes(webpageScopus, "section.abstractSection")
html_nodes(webpageScopus, "p")
html_nodes(webpageScopus, "p data-reportrenderTime")
html_nodes(webpageScopus, "p data-reportrendertime")
html_nodes(webpageScopus, "#//p")
html_nodes(webpageScopus, "#p")
html_nodes(webpageScopus, "p data-reportrendertime")
html_nodes(webpageScopus, "p")
html_nodes(webpageScopus, "p")[8]
scopusAbstract <- html_text(html_nodes(webpageScopus)[8])
webpageScopus <- read_html(as.character(urlScopus))
scopusAbstract <- html_text(html_nodes(webpageScopus, "p")[8])
scopusAbstract
webpageScopus <- read_html(as.character(in_scopus[458]))
scopusAbstract <- html_text(html_nodes(webpageScopus, "p")[8])
scopusAbstract
head(in_wos)
in_wos <- in_corpus[!grepl("scopus", in_corpus$ArticleURL), ]
head(in_wos)
View(head(in_wos))
names(in_wos)
table(in_wos$DOI_flag)
in_wos$DOI
in_wos$DOI[1]
in_wos$Title[1]
in_wos$Title[2]
in_wos$DOI[2]
webpageScopus <- "https://www.scopus.com/results/results.uri?numberOfFields=0&src=s&clickedLink=&edit=&editSaveSearch=&origin=searchbasic&authorTab=&affiliationTab=&advancedTab=&scint=1&menu=search&tablin=&searchterm1=+10.1002%2Fhyp.10995&field1=DOI&dateType=Publication_Date_Type&yearFrom=Before+1960&yearTo=Present&loadDate=7&documenttype=All&accessTypes=All&resetFormLink=&st1=+10.1002%2Fhyp.10995&st2=&sot=b&sdt=b&sl=23&s=DOI%28+10.1002%2Fhyp.10995%29&sid=96c83fd35d964bf36a4c276d57a5e93b&searchId=96c83fd35d964bf36a4c276d57a5e93b&txGid=621df8975ccb5e827795e1ecc578e2a9&sort=plf-f&originationType=b&rr="
urlScopus <- "https://www.scopus.com/results/results.uri?numberOfFields=0&src=s&clickedLink=&edit=&editSaveSearch=&origin=searchbasic&authorTab=&affiliationTab=&advancedTab=&scint=1&menu=search&tablin=&searchterm1=+10.1002%2Fhyp.10995&field1=DOI&dateType=Publication_Date_Type&yearFrom=Before+1960&yearTo=Present&loadDate=7&documenttype=All&accessTypes=All&resetFormLink=&st1=+10.1002%2Fhyp.10995&st2=&sot=b&sdt=b&sl=23&s=DOI%28+10.1002%2Fhyp.10995%29&sid=96c83fd35d964bf36a4c276d57a5e93b&searchId=96c83fd35d964bf36a4c276d57a5e93b&txGid=621df8975ccb5e827795e1ecc578e2a9&sort=plf-f&originationType=b&rr="
webpageScopus <- read_html(as.character(urlScopus))
html_nodes(webpageScopus, "#previewAbstract1")
html_nodes(webpageScopus, ".txt")
html_nodes(webpageScopus, "previewAbstract1.txt")
html_nodes(webpageScopus, "#previewAbstract1.txt")
html_nodes(webpageScopus, "#previewAbstract1")
html_nodes(html_nodes(webpageScopus, "#previewAbstract1"), ".text")
html_nodes(html_nodes(webpageScopus, "#previewAbstract1"), ".txt")
install.packages("rscopus")
rscopus::abstract_retrieval(in_wos$DOI[1], identifier="doi", verbose=TRUE)
library(rscopus)
set_api_key("b8b0698af42a2a93b41dc902260bde9d")
rscopus::abstract_retrieval(in_wos$DOI[1], identifier="doi", verbose=TRUE)
rscopus::abstract_retrieval(in_wos$DOI[12], identifier="doi", verbose=TRUE)
abstract_retrieval
??abstract_retrieval
generic_elsevier_api(query = in_wos$Title[1], type = "search", search_type = "abstract")
generic_elsevier_api(query = in_wos$Title[1], type = "abstract")
generic_elsevier_api(query = in_wos$Title[1], type = "article")
generic_elsevier_api(query = in_wos$Title[2], type = "article")
generic_elsevier_api(query = in_wos$Title[2], type = "abstract")
generic_elsevier_api(query = in_wos$Title[2], type = "search", search_type = "scopus")
res <- generic_elsevier_api(query = in_wos$Title[2], type = "search", search_type = "scopus")
str(res)
length(res)
str(res[1])
str(res[2])
in_wos$Title[2]
in_wos$DOI[2]
install.packages("wosr")
wosr::query_wos("10.1002/hyp.10995")
auth(username = NULL, password = NULL)
wosr::auth(username = NULL, password = NULL)
wosr::query_wos("10.1002/hyp.10995")
library(wosr)
wosr::auth(username = NULL, password = NULL)
wosr::query_wos("10.1002/hyp.10995", sid = auth(username = NULL, password = NULL))
in_scopus <- in_corpus$ArticleURL[grepl("scopus", in_corpus$ArticleURL)]
in_wos <- in_corpus[!grepl("scopus", in_corpus$ArticleURL), ]
#################
### libraries ###
#################
if(!require("rvest")) install.packages("rvest")
library("rvest")
##################
### parameters ###
##################
idFileName <- "something.csv"
#################
### functions ###
#################
get.scopusAbstract <- function(urlScopus){
webpageScopus <- read_html(as.character(urlScopus))
scopusAbstract <- html_text(html_nodes(webpageScopus, "p")[8])
return(scopusAbstract)
}
rscopus::set_api_key("b8b0698af42a2a93b41dc902260bde9d")
#previewAbstract1
# 10.1002/hyp.10995
# urlScopus <- "https://www.scopus.com/results/results.uri?numberOfFields=0&src=s&clickedLink=&edit=&editSaveSearch=&origin=searchbasic&authorTab=&affiliationTab=&advancedTab=&scint=1&menu=search&tablin=&searchterm1=+10.1002%2Fhyp.10995&field1=DOI&dateType=Publication_Date_Type&yearFrom=Before+1960&yearTo=Present&loadDate=7&documenttype=All&accessTypes=All&resetFormLink=&st1=+10.1002%2Fhyp.10995&st2=&sot=b&sdt=b&sl=23&s=DOI%28+10.1002%2Fhyp.10995%29&sid=96c83fd35d964bf36a4c276d57a5e93b&searchId=96c83fd35d964bf36a4c276d57a5e93b&txGid=621df8975ccb5e827795e1ecc578e2a9&sort=plf-f&originationType=b&rr="
# webpageScopus <- read_html(as.character(urlScopus))
############
### main ###
############
scopusAbstracts<- list()
for (i in seq_along(as.character(in_scopus))) {
if (!(as.character(in_scopus)[i] %in% names(scopusAbstracts))) {
cat(paste("Doing", as.character(in_scopus)[i], "..."))
ok <- FALSE
counter <- 0
while (ok == FALSE & counter <= 5) {
counter <- counter + 1
out <- tryCatch({
get.geneNameNCBI(as.character(in_scopus)[i])
},
error = function(e) {
Sys.sleep(2)
e
}
)
if ("error" %in% class(out)) {
cat(".")
} else {
ok <- TRUE
cat(" Done.")
}
}
cat("\n")
scopusAbstracts[[i]] <- out
names(scopusAbstracts)[i] <- as.character(in_scopus)[i]
}
}
scopusAbstracts<- list()
for (i in seq_along(as.character(in_scopus))) {
if (!(as.character(in_scopus)[i] %in% names(scopusAbstracts))) {
cat(paste("Doing", as.character(in_scopus)[i], "..."))
ok <- FALSE
counter <- 0
while (ok == FALSE & counter <= 5) {
counter <- counter + 1
out <- tryCatch({
get.scopusAbstract(as.character(in_scopus)[i])
},
error = function(e) {
Sys.sleep(2)
e
}
)
if ("error" %in% class(out)) {
cat(".")
} else {
ok <- TRUE
cat(" Done.")
}
}
cat("\n")
scopusAbstracts[[i]] <- out
names(scopusAbstracts)[i] <- as.character(in_scopus)[i]
}
}
scopusAbstracts
scopusAbstracts<- list()
for (i in seq_along(as.character(in_scopus))) {
if (!(as.character(in_scopus)[i] %in% names(scopusAbstracts))) {
cat(paste("Doing", as.character(in_scopus)[i], "..."))
ok <- FALSE
counter <- 0
while (ok == FALSE & counter <= 5) {
counter <- counter + 1
out <- tryCatch({
get.scopusAbstract(as.character(in_scopus)[i])
},
error = function(e) {
Sys.sleep(2)
e
}
)
if ("error" %in% class(out)) {
cat(".")
} else {
ok <- TRUE
cat(" Done.")
}
}
cat("\n")
scopusAbstracts[[i]] <- out
names(scopusAbstracts)[i] <- as.character(in_scopus)[i]
}
}
length(scopusAbstracts)
length(in_scopus)
length(is.na(scopusAbstracts))
table(is.na(scopusAbstracts))
write.csv(scopusAbstracts, "scopusAbstracts.csv", row.names = FALSE)
write.csv(data.frame(scopusAbstracts), "scopusAbstracts.csv", row.names = FALSE)
saveRDS(data.frame(scopusAbstracts), "scopusAbstracts.Rds")
saveRDS(scopusAbstracts, "scopusAbstracts.Rds")
ls
ls()
sample(scopusAbstracts, 1)
in_wos
View(head(in_wos))
in_wos$urls
in_wos$urls[1]
in_wos$urls[2]
table(grepl("wiley", in_wos$urls))
table(grepl("els", in_wos$urls))
in_wos$DOI[2]
rscopus
library(rscopus)
abstract_retrieval(in_wos$DOI[2], identifier = "doi")
abstract_retrieval(in_wos$DOI[2], identifier = "doi", verbose = FALSE)
res <- abstract_retrieval(in_wos$DOI[2], identifier = "doi", verbose = FALSE)
res$content
res
res$content$`abstracts-retrieval-response`$coredata$`dc:description`
get.WoSAbstract <- function(DOI){
res <- abstract_retrieval(DOI, identifier = "doi", verbose = FALSE)
WoSAbstract <- res$content$`abstracts-retrieval-response`$coredata$`dc:description`
return(WoSAbstract)
}
rscopus::set_api_key("b8b0698af42a2a93b41dc902260bde9d")
wosAbstracts<- list()
for (i in seq_along(in_wos$DOI))) {
if (!(as.character(in_wos)[i] %in% names(wosAbstracts))) {
cat(paste("Doing", in_wos$DOI[i], "..."))
ok <- FALSE
counter <- 0
while (ok == FALSE & counter <= 5) {
counter <- counter + 1
out <- tryCatch({
get.WoSAbstract(in_wos$DOI[i])
},
error = function(e) {
Sys.sleep(2)
e
}
)
if ("error" %in% class(out)) {
cat(".")
} else {
ok <- TRUE
cat(" Done.")
}
}
cat("\n")
wosAbstracts[[i]] <- out
names(wosAbstracts)[i] <- as.character(in_scopus)[i]
}
}
as.character(in_wos$DOI)
as.character(in_wos$DOI[1])
get.wosAbstract <- function(DOI){
res <- abstract_retrieval(DOI, identifier = "doi", verbose = FALSE)
wosAbstract <- res$content$`abstracts-retrieval-response`$coredata$`dc:description`
return(wosAbstract)
}
wosAbstracts<- list()
for (i in seq_along(as.character(in_wos$DOI))) {
if (!(as.character(in_wos$DOI)[i] %in% names(wosAbstracts))) {
cat(paste("Doing", as.character(in_wos$DOI)[i], "..."))
ok <- FALSE
counter <- 0
while (ok == FALSE & counter <= 5) {
counter <- counter + 1
out <- tryCatch({
get.wosAbstract(as.character(in_wos$DOI)[i])
},
error = function(e) {
Sys.sleep(2)
e
}
)
if ("error" %in% class(out)) {
cat(".")
} else {
ok <- TRUE
cat(" Done.")
}
}
cat("\n")
wosAbstracts[[i]] <- out
names(wosAbstracts)[i] <- as.character(in_wos$DOI)[i]
}
}
in_wos <- in_wos$DOI
rscopus::set_api_key("b8b0698af42a2a93b41dc902260bde9d")
wosAbstracts<- list()
for (i in seq_along(as.character(in_wos))) {
if (!(as.character(in_wos)[i] %in% names(wosAbstracts))) {
cat(paste("Doing", as.character(in_wos)[i], "..."))
ok <- FALSE
counter <- 0
while (ok == FALSE & counter <= 5) {
counter <- counter + 1
out <- tryCatch({
get.wosAbstract(as.character(in_wos)[i])
},
error = function(e) {
Sys.sleep(2)
e
}
)
if ("error" %in% class(out)) {
cat(".")
} else {
ok <- TRUE
cat(" Done.")
}
}
cat("\n")
wosAbstracts[[i]] <- out
names(wosAbstracts)[i] <- as.character(in_wos)[i]
}
}
wosAbstracts
i
as.character(in_wos)[i]
get.wosAbstract <- function(DOI){
res <- abstract_retrieval(DOI, identifier = "doi", verbose = FALSE)
wosAbstract <- res$content$`abstracts-retrieval-response`$coredata$`dc:description`
return(wosAbstract)
}
out
in_wos
rscopus::set_api_key("b8b0698af42a2a93b41dc902260bde9d")
wosAbstracts <- list()
for (i in seq_along(as.character(in_wos))) {
if (!(as.character(in_wos)[i] %in% names(wosAbstracts))) {
cat(paste("Doing", as.character(in_wos)[i], "..."))
ok <- FALSE
counter <- 0
while (ok == FALSE & counter <= 5) {
counter <- counter + 1
out <- tryCatch({
get.wosAbstract(as.character(in_wos)[i])
},
error = function(e) {
Sys.sleep(2)
e
}
)
if ("error" %in% class(out)) {
cat(".")
} else {
ok <- TRUE
cat(" Done.")
}
}
cat("\n")
wosAbstracts[[i]] <- out
names(wosAbstracts)[i] <- as.character(in_wos)[i]
}
}
out
get.wosAbstract(as.character(in_wos)[i])
res <- abstract_retrieval(DOI, identifier = "doi", verbose = FALSE)
wosAbstract <- res$content$`abstracts-retrieval-response`$coredata$`dc:description`
res <- abstract_retrieval(in_wos[1], identifier = "doi", verbose = FALSE)
wosAbstract <- res$content$`abstracts-retrieval-response`$coredata$`dc:description`
res
is.null(out)
rscopus::set_api_key("b8b0698af42a2a93b41dc902260bde9d")
wosAbstracts <- list()
for (i in seq_along(as.character(in_wos))) {
if (!(as.character(in_wos)[i] %in% names(wosAbstracts))) {
cat(paste("Doing", as.character(in_wos)[i], "..."))
ok <- FALSE
counter <- 0
while (ok == FALSE & counter <= 5) {
counter <- counter + 1
out <- tryCatch({
get.wosAbstract(as.character(in_wos)[i])
},
error = function(e) {
Sys.sleep(2)
e
}
)
if ("error" %in% class(out)) {
cat(".")
} else {
ok <- TRUE
cat(" Done.")
}
}
cat("\n")
wosAbstracts[[i]] <- ifelse(is.null(out), NA, out)
names(wosAbstracts)[i] <- as.character(in_wos)[i]
}
}
wosAbstracts
rscopus::set_api_key("b8b0698af42a2a93b41dc902260bde9d")
wosAbstracts <- list()
for (i in seq_along(as.character(in_wos))) {
if (!(as.character(in_wos)[i] %in% names(wosAbstracts))) {
cat(paste("Doing", as.character(in_wos)[i], "..."))
ok <- FALSE
counter <- 0
while (ok == FALSE & counter <= 5) {
counter <- counter + 1
out <- tryCatch({
get.wosAbstract(as.character(in_wos)[i])
},
error = function(e) {
Sys.sleep(2)
e
}
)
if ("error" %in% class(out)) {
cat(".")
} else {
ok <- TRUE
cat(" Done.")
}
}
cat("\n")
wosAbstracts[[i]] <- ifelse(is.null(out), NA, out)
names(wosAbstracts)[i] <- as.character(in_wos)[i]
}
}
length(is.na(wosAbstracts))
table(is.na(wosAbstracts))
Amelia::missmap(data.frame(wosAbstracts))
Amelia::missmap(as.data.frame(wosAbstracts))
Amelia::missmap(cbind(wosAbstracts, wosAbstracts))
sample(wosAbstracts, 1)
sample(wosAbstracts, 1)
sample(wosAbstracts, 1)
sample(wosAbstracts, 1)
sample(wosAbstracts, 1)
sample(wosAbstracts, 1)
ind_scopus <- grep("scopus", in_corpus$ArticleURL)
ind_wos <- !grep("scopus", in_corpus$ArticleURL)
in_corpus$abstract <- rep(NA, nrow(in_corpus))
in_corpus$abstract[ind_scopus] <- scopusAbstracts
in_corpus$abstract[ind_wos] <- wosAbstracts
Amelia::missmap(cbind(in_corpus$abstract))
Amelia::missmap(cbind(in_corpus$abstract))
table(is.na(scopusAbstracts))
sample(wosAbstracts, 2)
sample(wosAbstracts, 2)
sample(wosAbstracts, 2)
sample(wosAbstracts, 2)
sample(wosAbstracts, 2)
sample(wosAbstracts, 2)
sample(wosAbstracts, 2)
sample(wosAbstracts, 2)
sample(wosAbstracts, 2)
sample(wosAbstracts, 2)
sample(wosAbstracts, 2)
sample(wosAbstracts, 2)
sample(scopusAbstracts, 2)
sample(scopusAbstracts, 2)
sample(scopusAbstracts, 2)
sample(scopusAbstracts, 2)
sample(scopusAbstracts, 2)
sample(scopusAbstracts, 2)
sample(scopusAbstracts, 2)
sample(scopusAbstracts, 2)
sample(scopusAbstracts, 2)
sample(scopusAbstracts, 2)
sample(scopusAbstracts, 2)
sample(scopusAbstracts, 2)
sample(scopusAbstracts, 2)
sample(scopusAbstracts, 2)
sample(scopusAbstracts, 2)
sample(scopusAbstracts, 2)
sample(scopusAbstracts, 2)
sample(scopusAbstracts, 2)
any(ind_scopus == ind_wos)
any(ind_scopus %in% ind_wos)
saveRDS(in_corpus, "in_corpus.Rds")
table(is.na(in_corpus$abstract))
table(is.na(wosAbstracts))
head(ind_wos)
ind_scopus <- which(grep("scopus", in_corpus$ArticleURL))
ind_wos <- which(!grep("scopus", in_corpus$ArticleURL))
ind_scopus <- which(grepl("scopus", in_corpus$ArticleURL) == TRUE)
ind_wos <- which(grepl("scopus", in_corpus$ArticleURL) == FALSE)
in_corpus$abstract <- rep(NA, nrow(in_corpus))
in_corpus$abstract[ind_scopus] <- scopusAbstracts
in_corpus$abstract[ind_wos] <- wosAbstracts
table(is.na(in_corpus$abstract))
Amelia::missmap(cbind(in_corpus$abstract))
saveRDS(in_corpus, "in_corpus.Rds")
1158/20039
head(in_corpus[is.na(in_corpus$abstract), ])
table(in_corpus[is.na(in_corpus$abstract), ]$Journal)
table(in_corpus[is.na(in_corpus$abstract), ]$periodical)
table(in_corpus[is.na(in_corpus$abstract), ]$Year)
dim(in_corpus)
in_corpus$abstrac==NULL
in_corpus$abstract=NULL
in_corpus$abstract == NULL
in_corpus$abstract
in_corpus <- readRDS("in_corpus.Rds")
in_corpus$abstract
which(in_corpus$abstract == NULL)
which(in_corpus$abstract == NA)
which(in_corpus$abstract == "NA")
table(in_corpus$abstract == "NA"))
table(in_corpus$abstract == "NA")
table(in_corpus$abstract == "NULL")
