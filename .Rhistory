df <- remove_year(budget) # pick data to work with
df <- remove_irrelevant(df)
df <- melt(df, id.vars = "country")
## count # papers per country
sums <- aggregate(df$value, by=list(df$country,df$variable), FUN=sum)
names(sums) = c("country","topic","sum")
country_sums <- aggregate(sums$sum, by=list(sums$country), FUN=sum) # no. papers per country
names(country_sums) = c("country","no.papers")
remove <- as.data.frame(country_sums$country[country_sums$no.papers < 30]) # list countries w/ < 30 papers
keep <- as.data.frame(country_sums$country[country_sums$no.papers > 30])
## subset countries with > 30 papers
df<- subset(df, df$country %in% keep$`country_sums$country[country_sums$no.papers > 30]`)
names(df) = c("country","topic","value")
## summarize country x topic
sums <-aggregate(df$value, by=list(df$country,df$topic), FUN=sum) # re - summarize after removing countries w/ < 30 papers
names(sums) = c("country","topic","sum")
## country description
country <- df %>%
group_by(country) %>%
mutate(total = sum(value)) %>% # total = # of papers
select(-c("topic","value")) %>%
distinct()
topic <- df %>% # uses df of individual papers
select(-c("country")) %>%
group_by(topic) %>%
mutate(total = sum(value)) %>%
mutate(sd = sd(value)) %>%
mutate(mean = mean(value)) %>%
mutate(var = var(value)) %>%
mutate(cv = sd/mean) %>%
select(-c("value")) %>%
distinct()
topic$prop <- topic$total/sum(topic$total)
topic_other<- sums %>% # use sums df
group_by(topic) %>%
mutate(total = sum(sum)) %>%
mutate(sd = sd(sum)) %>%
mutate(mean = mean(sum)) %>%
mutate(var = var(sum)) %>%
mutate(cv = sd/mean) %>%
select(-c("country","sum")) %>%
distinct()
topic_other$prop <- topic_other$total/sum(topic_other$total)
pca <- ggscatter(topic, x= "prop", y = "var",
label = "topic",
label.rectangle = TRUE,
repel = TRUE,
dd = "reg.line"
)
pca
pca <- ggscatter(topic, x= "prop", y = "var",
label = "topic",
label.rectangle = TRUE,
repel = TRUE,
add = "reg.line"
)
pca
pca <- ggscatter(topic, x= "prop", y = "mean",
label = "topic",
label.rectangle = TRUE,
repel = TRUE,
add = "reg.line"
)
pca
pca <- ggscatter(topic, x= "prop", y = "mean",
label = "topic",
label.rectangle = TRUE,
repel = TRUE
#add = "reg.line"
)
pca
View(sums)
View(df)
pca <- ggscatter(topic, x= "total", y = "mean",
label = "topic",
label.rectangle = TRUE,
repel = TRUE
#add = "reg.line"
)
pca
topic <- df %>% # uses df of individual papers
select(-c("country")) %>%
group_by(topic) %>%
mutate(total = sum(value)) %>%
mutate(sd = sd(value)) %>%
mutate(mean = mean(value)) %>%
mutate(var = var(value)) %>%
mutate(cv = sd/mean) %>%
mutate(prop = total/sum(total)) %>%
select(-c("value")) %>%
distinct()
.180/.09
topic$prop <- topic$total/sum(topic$total)
sum(topic$total)
1164/12621
sum(topic$prop)
pca <- ggscatter(topic, x= "prop", y = "sd",
label = "topic",
label.rectangle = TRUE,
repel = TRUE
#add = "reg.line"
)
pca
pca <- ggscatter(topic, x= "prop", y = "sd",
label = "topic",
label.rectangle = TRUE,
repel = TRUE,
add = "reg.line"
)
pca
pca <- ggscatter(topic, x= "prop", y = "cv",
label = "topic",
label.rectangle = TRUE,
repel = TRUE,
add = "reg.line"
)
pca
df <- remove_year(methods) # pick data to work with
df <- remove_irrelevant(df)
df <- melt(df, id.vars = "country")
## count # papers per country
sums <- aggregate(df$value, by=list(df$country,df$variable), FUN=sum)
names(sums) = c("country","topic","sum")
country_sums <- aggregate(sums$sum, by=list(sums$country), FUN=sum) # no. papers per country
names(country_sums) = c("country","no.papers")
remove <- as.data.frame(country_sums$country[country_sums$no.papers < 30]) # list countries w/ < 30 papers
keep <- as.data.frame(country_sums$country[country_sums$no.papers > 30])
## subset countries with > 30 papers
df<- subset(df, df$country %in% keep$`country_sums$country[country_sums$no.papers > 30]`)
names(df) = c("country","topic","value")
## summarize country x topic
sums <-aggregate(df$value, by=list(df$country,df$topic), FUN=sum) # re - summarize after removing countries w/ < 30 papers
names(sums) = c("country","topic","sum")
# SAVE for mapping
# write.csv(sums,'./diversity/csvs/nsfspecific.csv')
## country description
country <- df %>%
group_by(country) %>%
mutate(total = sum(value)) %>% # total = # of papers
select(-c("topic","value")) %>%
distinct()
## topic description
topic <- df %>% # uses df of individual papers
select(-c("country")) %>%
group_by(topic) %>%
mutate(total = sum(value)) %>%
mutate(sd = sd(value)) %>%
mutate(mean = mean(value)) %>%
mutate(var = var(value)) %>% # measures how far a set of numbers are spread out from their average value
mutate(cv = sd/mean) %>% # extent of variability in relation to the mean of the population
select(-c("value")) %>%
distinct()
topic$prop <- topic$total/sum(topic$total)
# topic_other<- sums %>% # use sums df
#   group_by(topic) %>%
#   mutate(total = sum(sum)) %>%
#   mutate(sd = sd(sum)) %>%
#   mutate(mean = mean(sum)) %>%
#   mutate(var = var(sum)) %>%
#   mutate(cv = sd/mean) %>%
#   select(-c("country","sum")) %>%
#   distinct()
# topic_other$prop <- topic_other$total/sum(topic_other$total)
pca <- ggscatter(topic, x= "prop", y = "cv",
label = "topic",
label.rectangle = TRUE,
repel = TRUE,
add = "reg.line"
)
pca
pca <- ggscatter(topic, x= "prop", y = "var",
label = "topic",
label.rectangle = TRUE,
repel = TRUE,
add = "reg.line"
)
pca
## define data frame
df <- remove_year(budget) # pick data to work with
df <- remove_irrelevant(df)
df <- melt(df, id.vars = "country")
## count # papers per country
sums <- aggregate(df$value, by=list(df$country,df$variable), FUN=sum)
names(sums) = c("country","topic","sum")
country_sums <- aggregate(sums$sum, by=list(sums$country), FUN=sum) # no. papers per country
names(country_sums) = c("country","no.papers")
remove <- as.data.frame(country_sums$country[country_sums$no.papers < 30]) # list countries w/ < 30 papers
keep <- as.data.frame(country_sums$country[country_sums$no.papers > 30])
## subset countries with > 30 papers
df<- subset(df, df$country %in% keep$`country_sums$country[country_sums$no.papers > 30]`)
names(df) = c("country","topic","value")
## summarize country x topic
sums <-aggregate(df$value, by=list(df$country,df$topic), FUN=sum) # re - summarize after removing countries w/ < 30 papers
names(sums) = c("country","topic","sum")
## country description
country <- df %>%
group_by(country) %>%
mutate(total = sum(value)) %>% # total = # of papers
select(-c("topic","value")) %>%
distinct()
topic <- df %>% # uses df of individual papers
select(-c("country")) %>%
group_by(topic) %>%
mutate(total = sum(value)) %>%
mutate(sd = sd(value)) %>%
mutate(mean = mean(value)) %>%
mutate(var = var(value)) %>% # Variance measures the dispersion of a set of data points around their mean value
mutate(cv = sd/mean) %>% # extent of variability in relation to the mean of the population
select(-c("value")) %>%
distinct()
topic$prop <- topic$total/sum(topic$total)
pca <- ggscatter(topic, x= "prop", y = "sd",
label = "topic",
label.rectangle = TRUE,
repel = TRUE,
add = "reg.line"
)
pca
## define data frame
df <- remove_year(methods) # pick data to work with
df <- remove_irrelevant(df)
df <- melt(df, id.vars = "country")
## count # papers per country
sums <- aggregate(df$value, by=list(df$country,df$variable), FUN=sum)
names(sums) = c("country","topic","sum")
country_sums <- aggregate(sums$sum, by=list(sums$country), FUN=sum) # no. papers per country
names(country_sums) = c("country","no.papers")
remove <- as.data.frame(country_sums$country[country_sums$no.papers < 30]) # list countries w/ < 30 papers
keep <- as.data.frame(country_sums$country[country_sums$no.papers > 30])
## subset countries with > 30 papers
df<- subset(df, df$country %in% keep$`country_sums$country[country_sums$no.papers > 30]`)
names(df) = c("country","topic","value")
## summarize country x topic
sums <-aggregate(df$value, by=list(df$country,df$topic), FUN=sum) # re - summarize after removing countries w/ < 30 papers
names(sums) = c("country","topic","sum")
## country description
country <- df %>%
group_by(country) %>%
mutate(total = sum(value)) %>% # total = # of papers
select(-c("topic","value")) %>%
distinct()
topic <- df %>% # uses df of individual papers
select(-c("country")) %>%
group_by(topic) %>%
mutate(total = sum(value)) %>%
mutate(sd = sd(value)) %>%
mutate(mean = mean(value)) %>%
mutate(var = var(value)) %>% # Variance measures the dispersion of a set of data points around their mean value
mutate(cv = sd/mean) %>% # extent of variability in relation to the mean of the population
select(-c("value")) %>%
distinct()
topic$prop <- topic$total/sum(topic$total)
pca <- ggscatter(topic, x= "prop", y = "sd",
label = "topic",
label.rectangle = TRUE,
repel = TRUE,
add = "reg.line"
)
pca
## define data frame
df <- remove_year(specific) # pick data to work with
df <- remove_irrelevant(df)
df <- melt(df, id.vars = "country")
## count # papers per country
sums <- aggregate(df$value, by=list(df$country,df$variable), FUN=sum)
names(sums) = c("country","topic","sum")
country_sums <- aggregate(sums$sum, by=list(sums$country), FUN=sum) # no. papers per country
names(country_sums) = c("country","no.papers")
remove <- as.data.frame(country_sums$country[country_sums$no.papers < 30]) # list countries w/ < 30 papers
keep <- as.data.frame(country_sums$country[country_sums$no.papers > 30])
## subset countries with > 30 papers
df<- subset(df, df$country %in% keep$`country_sums$country[country_sums$no.papers > 30]`)
names(df) = c("country","topic","value")
## summarize country x topic
sums <-aggregate(df$value, by=list(df$country,df$topic), FUN=sum) # re - summarize after removing countries w/ < 30 papers
names(sums) = c("country","topic","sum")
## country description
country <- df %>%
group_by(country) %>%
mutate(total = sum(value)) %>% # total = # of papers
select(-c("topic","value")) %>%
distinct()
topic <- df %>% # uses df of individual papers
select(-c("country")) %>%
group_by(topic) %>%
mutate(total = sum(value)) %>%
mutate(sd = sd(value)) %>%
mutate(mean = mean(value)) %>%
mutate(var = var(value)) %>% # Variance measures the dispersion of a set of data points around their mean value
mutate(cv = sd/mean) %>% # extent of variability in relation to the mean of the population
select(-c("value")) %>%
distinct()
topic$prop <- topic$total/sum(topic$total)
pca <- ggscatter(topic, x= "prop", y = "sd",
label = "topic",
label.rectangle = TRUE,
repel = TRUE,
add = "reg.line"
)
pca
## define data frame
df <- remove_year(general) # pick data to work with
df <- remove_irrelevant(df)
df <- melt(df, id.vars = "country")
## count # papers per country
sums <- aggregate(df$value, by=list(df$country,df$variable), FUN=sum)
names(sums) = c("country","topic","sum")
country_sums <- aggregate(sums$sum, by=list(sums$country), FUN=sum) # no. papers per country
names(country_sums) = c("country","no.papers")
remove <- as.data.frame(country_sums$country[country_sums$no.papers < 30]) # list countries w/ < 30 papers
keep <- as.data.frame(country_sums$country[country_sums$no.papers > 30])
## subset countries with > 30 papers
df<- subset(df, df$country %in% keep$`country_sums$country[country_sums$no.papers > 30]`)
names(df) = c("country","topic","value")
## summarize country x topic
sums <-aggregate(df$value, by=list(df$country,df$topic), FUN=sum) # re - summarize after removing countries w/ < 30 papers
names(sums) = c("country","topic","sum")
## country description
country <- df %>%
group_by(country) %>%
mutate(total = sum(value)) %>% # total = # of papers
select(-c("topic","value")) %>%
distinct()
topic <- df %>% # uses df of individual papers
select(-c("country")) %>%
group_by(topic) %>%
mutate(total = sum(value)) %>%
mutate(sd = sd(value)) %>%
mutate(mean = mean(value)) %>%
mutate(var = var(value)) %>% # Variance measures the dispersion of a set of data points around their mean value
mutate(cv = sd/mean) %>% # extent of variability in relation to the mean of the population
select(-c("value")) %>%
distinct()
topic$prop <- topic$total/sum(topic$total)
pca <- ggscatter(topic, x= "prop", y = "sd",
label = "topic",
label.rectangle = TRUE,
repel = TRUE,
add = "reg.line"
)
pca
View(budget)
View(df)
View(general)
View(topic)
View(topic)
topic <- df %>% # uses df of individual papers
select(-c("country")) %>%
group_by(topic) %>%
mutate(total = sum(value)) %>%
mutate(sd = sd(value)) %>%
mutate(mean = mean(value)) %>%
mutate(var = var(value)) %>% # Variance measures the dispersion of a set of data points around their mean value
mutate(cv = sd/mean) %>% # extent of variability in relation to the mean of the population
mutate(diversity = diversity(value)) %<%
select(-c("value")) %>%
distinct()
topic <- df %>% # uses df of individual papers
select(-c("country")) %>%
group_by(topic) %>%
mutate(total = sum(value)) %>%
mutate(sd = sd(value)) %>%
mutate(mean = mean(value)) %>%
mutate(var = var(value)) %>% # Variance measures the dispersion of a set of data points around their mean value
mutate(cv = sd/mean) %>% # extent of variability in relation to the mean of the population
mutate(diversity = diversity(value)) %.%
select(-c("value")) %>%
distinct()
topic <- df %>% # uses df of individual papers
select(-c("country")) %>%
group_by(topic) %>%
mutate(total = sum(value)) %>%
mutate(sd = sd(value)) %>%
mutate(mean = mean(value)) %>%
mutate(var = var(value)) %>% # Variance measures the dispersion of a set of data points around their mean value
mutate(cv = sd/mean) %>% # extent of variability in relation to the mean of the population
mutate(diversity = diversity(value)) %>%
select(-c("value")) %>%
distinct()
topic$prop <- topic$total/sum(topic$total)
df <- remove_year(budget) # pick data to work with
df <- remove_irrelevant(df)
df <- melt(df, id.vars = "country")
## count # papers per country
sums <- aggregate(df$value, by=list(df$country,df$variable), FUN=sum)
names(sums) = c("country","topic","sum")
country_sums <- aggregate(sums$sum, by=list(sums$country), FUN=sum) # no. papers per country
names(country_sums) = c("country","no.papers")
remove <- as.data.frame(country_sums$country[country_sums$no.papers < 30]) # list countries w/ < 30 papers
keep <- as.data.frame(country_sums$country[country_sums$no.papers > 30])
## subset countries with > 30 papers
df<- subset(df, df$country %in% keep$`country_sums$country[country_sums$no.papers > 30]`)
names(df) = c("country","topic","value")
## summarize country x topic
sums <-aggregate(df$value, by=list(df$country,df$topic), FUN=sum) # re - summarize after removing countries w/ < 30 papers
names(sums) = c("country","topic","sum")
# SAVE for mapping
# write.csv(sums,'./diversity/csvs/nsfspecific.csv')
## country description
country <- df %>%
group_by(country) %>%
mutate(total = sum(value)) %>% # total = # of papers
select(-c("topic","value")) %>%
distinct()
## topic description
topic <- df %>% # uses df of individual papers
select(-c("country")) %>%
group_by(topic) %>%
mutate(total = sum(value)) %>%
mutate(sd = sd(value)) %>%
mutate(mean = mean(value)) %>%
mutate(var = var(value)) %>% # Variance measures the dispersion of a set of data points around their mean value
mutate(cv = sd/mean) %>% # extent of variability in relation to the mean of the population
mutate(diversity = diversity(value)) %>%
select(-c("value")) %>%
distinct()
topic$prop <- topic$total/sum(topic$total)
pca <- ggscatter(topic, x= "prop", y = "diversity",
label = "topic",
label.rectangle = TRUE,
repel = TRUE,
add = "reg.line"
)
pca
df <- remove_year(methods) # pick data to work with
df <- remove_irrelevant(df)
df <- melt(df, id.vars = "country")
## count # papers per country
sums <- aggregate(df$value, by=list(df$country,df$variable), FUN=sum)
names(sums) = c("country","topic","sum")
country_sums <- aggregate(sums$sum, by=list(sums$country), FUN=sum) # no. papers per country
names(country_sums) = c("country","no.papers")
remove <- as.data.frame(country_sums$country[country_sums$no.papers < 30]) # list countries w/ < 30 papers
keep <- as.data.frame(country_sums$country[country_sums$no.papers > 30])
## subset countries with > 30 papers
df<- subset(df, df$country %in% keep$`country_sums$country[country_sums$no.papers > 30]`)
names(df) = c("country","topic","value")
## summarize country x topic
sums <-aggregate(df$value, by=list(df$country,df$topic), FUN=sum) # re - summarize after removing countries w/ < 30 papers
names(sums) = c("country","topic","sum")
# SAVE for mapping
# write.csv(sums,'./diversity/csvs/nsfspecific.csv')
## country description
country <- df %>%
group_by(country) %>%
mutate(total = sum(value)) %>% # total = # of papers
select(-c("topic","value")) %>%
distinct()
## topic description
topic <- df %>% # uses df of individual papers
select(-c("country")) %>%
group_by(topic) %>%
mutate(total = sum(value)) %>%
mutate(sd = sd(value)) %>%
mutate(mean = mean(value)) %>%
mutate(var = var(value)) %>% # Variance measures the dispersion of a set of data points around their mean value
mutate(cv = sd/mean) %>% # extent of variability in relation to the mean of the population
mutate(diversity = diversity(value)) %>%
select(-c("value")) %>%
distinct()
topic$prop <- topic$total/sum(topic$total)
pca <- ggscatter(topic, x= "prop", y = "diversity",
label = "topic",
label.rectangle = TRUE,
repel = TRUE,
add = "reg.line"
)
pca
df <- remove_year(specific) # pick data to work with
df <- remove_irrelevant(df)
df <- melt(df, id.vars = "country")
## count # papers per country
sums <- aggregate(df$value, by=list(df$country,df$variable), FUN=sum)
names(sums) = c("country","topic","sum")
country_sums <- aggregate(sums$sum, by=list(sums$country), FUN=sum) # no. papers per country
names(country_sums) = c("country","no.papers")
remove <- as.data.frame(country_sums$country[country_sums$no.papers < 30]) # list countries w/ < 30 papers
keep <- as.data.frame(country_sums$country[country_sums$no.papers > 30])
## subset countries with > 30 papers
df<- subset(df, df$country %in% keep$`country_sums$country[country_sums$no.papers > 30]`)
names(df) = c("country","topic","value")
## summarize country x topic
sums <-aggregate(df$value, by=list(df$country,df$topic), FUN=sum) # re - summarize after removing countries w/ < 30 papers
names(sums) = c("country","topic","sum")
# SAVE for mapping
# write.csv(sums,'./diversity/csvs/nsfspecific.csv')
## country description
country <- df %>%
group_by(country) %>%
mutate(total = sum(value)) %>% # total = # of papers
select(-c("topic","value")) %>%
distinct()
## topic description
topic <- df %>% # uses df of individual papers
select(-c("country")) %>%
group_by(topic) %>%
mutate(total = sum(value)) %>%
mutate(sd = sd(value)) %>%
mutate(mean = mean(value)) %>%
mutate(var = var(value)) %>% # Variance measures the dispersion of a set of data points around their mean value
mutate(cv = sd/mean) %>% # extent of variability in relation to the mean of the population
mutate(diversity = diversity(value)) %>%
select(-c("value")) %>%
distinct()
topic$prop <- topic$total/sum(topic$total)
pca <- ggscatter(topic, x= "prop", y = "diversity",
label = "topic",
label.rectangle = TRUE,
repel = TRUE,
add = "reg.line"
)
pca
