}
diversity_in_LAC <- diversity_in_LAC(specific)
diversity_in_LAC <- function(df) {
# b. diversity in LAC
b <- remove_year(df)
b <- remove_country(b)
b <- as.data.frame(colSums(b))
b <- diversity(b)
return(b)
}
diversity_in_LAC <- diversity_in_LAC(specific)
################### analysis #########################
diversity_by_paper <- diversity_by_paper(specific)
diversity_paper <- function(df) {
# a. diversity of each paper
a <- remove_year(df)
a <- remove_country(a)
a <- diversity(a)
return(a)
}
diversity_LAC <- function(df) {
# b. diversity in LAC
b <- remove_year(df)
b <- remove_country(b)
b <- as.data.frame(colSums(b))
b <- diversity(b)
return(b)
}
diversity_country <- function(df) {
# C. diversity per country
c <- melt(df,
id.vars = c("country"))
c <- aggregate(c$value, by=list(c$country,c$variable), FUN=sum)
c <- c %>%
rename(country = Group.1, sepcies = Group.2, population = x) # species is country*topic
c <- group_by(c, country)
c <- do(c, tidy(diversity(.$population)))
return(c)
}
diversity_country <- diversity(specific)
diversity_country <- diversity_country(specific)
View(diversity_country)
diversity_country <- diversity_country(theme)
diversity_country <- function(df) {
# C. diversity per country
c <- melt(df,
id.vars = c("country"))
c <- aggregate(c$value, by=list(c$country,c$variable), FUN=sum)
c <- c %>%
rename(country = Group.1, sepcies = Group.2, population = x) # species is country*topic
c <- group_by(c, country)
c <- do(c, tidy(diversity(.$population)))
return(c)
}
diversity_country <- diversity_country(theme)
View(diversity_country)
View(theme)
# C. diversity per country
c <- remove_year(df)
diversity_country <- function(df) {
# C. diversity per country
c <- remove_year(df)
c <- melt(df,
id.vars = c("country"))
c <- aggregate(c$value, by=list(c$country,c$variable), FUN=sum)
c <- c %>%
rename(country = Group.1, sepcies = Group.2, population = x) # species is country*topic
c <- group_by(c, country)
c <- do(c, tidy(diversity(.$population)))
return(c)
}
diversity_country <- function(df) {
# C. diversity per country
c <- remove_year(df)
c <- melt(df,
id.vars = c("country"))
c <- aggregate(c$value, by=list(c$country,c$variable), FUN=sum)
c <- c %>%
rename(country = Group.1, sepcies = Group.2, population = x) # species is country*topic
c <- group_by(c, country)
c <- do(c, tidy(diversity(.$population)))
return(c)
}
diversity_country <- diversity_country(theme)
View(diversity_country)
View(theme)
c <- remove_year(theme)
c <- melt(c,
id.vars = c("country"))
c <- aggregate(c$value, by=list(c$country,c$variable), FUN=sum)
c <- c %>%
rename(country = Group.1, sepcies = Group.2, population = x) # species is country*topic
c <- group_by(c, country)
c <- do(c, tidy(diversity(.$population)))
View(c)
diversity_country <- function(df) {
# C. diversity per country
c <- remove_year(df)
c <- melt(df,
id.vars = c("country"))
c <- aggregate(c$value, by=list(c$country,c$variable), FUN=sum)
c <- c %>%
rename(country = Group.1, sepcies = Group.2, population = x) # species is country*topic
c <- group_by(c, country)
c2 <- do(c, tidy(diversity(.$population)))
return(c2)
}
diversity_country <- diversity_country(theme)
View(diversity_country)
View(diversity_country)
View(c)
################### libraries #########################
library(dplyr)
library(vegan)
library(broom)
library(reshape2)
################### files #########################
general <- readRDS("./consolidated_results_NSF_general.Rds")
specific <- readRDS("./consolidated_results_NSF_specific.Rds")
theme <- readRDS("./consolidated_results_theme.Rds")
methods <- readRDS("./consolidated_results_methods.Rds")
budget <- readRDS("./consolidated_results_water budget.Rds")
remove_year_country <- function(df) {
df <- df %>%
select(-c("year","country"))
return(df)
}
general_clean <- remove_year_country(general)
clean <- remove_year_country(general)
diversity_paper <- diversity(clean)
diversity_LAC <- function(df) {
df <- as.data.frame(colSums(df))
df <- diversity(df)
return(df)
}
View(clean)
diversity_LAC <- function(df) {
df <- colSums(df)
df <- diversity(df)
return(df)
}
diversity_LAC <- diversity_LAC(clean)
diversity_country <- function(df) {
# C. diversity per country
df <- remove_year(df)
df <- melt(df,
id.vars = c("country"))
df <- aggregate(df$value, by=list(df$country,df$variable), FUN=sum)
df <- df %>%
rename(country = Group.1, sepcies = Group.2, population = x) # species is country*topic
df <- group_by(df, country)
df <- do(df, tidy(diversity(.$population)))
return(c2)
}
# C. diversity per country
df <- df %>%
select(-c("year"))
View(general)
diversity_country <- function(df) {
df <- df %>%
select(-c("year"))
df <- melt(df,
id.vars = c("country"))
df <- aggregate(df$value, by=list(df$country,df$variable), FUN=sum)
df <- df %>%
rename(country = Group.1, sepcies = Group.2, population = x) # species is country*topic
df <- group_by(df, country)
df <- do(df, tidy(diversity(.$population)))
return(df)
}
diversity_country <- diversity_country(general)
View(diversity_country)
# calculate diversity by country
general2 <- diversity_country(general)
diversity_country <- function(df) {
df <- df %>%
select(-c("year"))
df <- melt(df,
id.vars = c("country"))
df <- aggregate(df$value, by=list(df$country,df$variable), FUN=sum)
df <- df %>%
rename(country = Group.1, sepcies = Group.2, population = x) # species is country*topic
df <- group_by(df, country)
df <- do(df, tidy(diversity(.$population)))
return(df)
}
################### libraries #########################
library(dplyr)
library(vegan)
library(broom)
library(reshape2)
################### files #########################
general <- readRDS("./consolidated_results_NSF_general.Rds")
specific <- readRDS("./consolidated_results_NSF_specific.Rds")
theme <- readRDS("./consolidated_results_theme.Rds")
methods <- readRDS("./consolidated_results_methods.Rds")
budget <- readRDS("./consolidated_results_water budget.Rds")
################### functions #########################
remove_irrelevant <- function(df) {
df_clean <- df %>%
filter(country != "Irrelevant")
return(df_clean)
} # don't need?
remove_year_country <- function(df) {
df <- df %>%
select(-c("year","country"))
return(df)
}
diversity_LAC <- function(df) {
df <- colSums(df)
df <- diversity(df)
return(df)
}
diversity_country <- function(df) {
df <- df %>%
select(-c("year"))
df <- melt(df,
id.vars = c("country"))
df <- aggregate(df$value, by=list(df$country,df$variable), FUN=sum)
df <- df %>%
rename(country = Group.1, sepcies = Group.2, population = x) # species is country*topic
df <- group_by(df, country)
df <- do(df, tidy(diversity(.$population)))
return(df)
}
################### libraries #########################
library(dplyr)
library(vegan)
library(broom)
library(reshape2)
################### files #########################
general <- readRDS("./consolidated_results_NSF_general.Rds")
specific <- readRDS("./consolidated_results_NSF_specific.Rds")
theme <- readRDS("./consolidated_results_theme.Rds")
methods <- readRDS("./consolidated_results_methods.Rds")
budget <- readRDS("./consolidated_results_water budget.Rds")
################### functions #########################
remove_irrelevant <- function(df) {
df_clean <- df %>%
filter(country != "Irrelevant")
return(df_clean)
} # don't need?
remove_year_country <- function(df) {
df <- df %>%
select(-c("year","country"))
return(df)
}
diversity_LAC <- function(df) {
df <- colSums(df)
df <- diversity(df)
return(df)
}
diversity_country <- function(df) {
df <- df %>%
select(-c("year"))
df <- melt(df,
id.vars = c("country"))
df <- aggregate(df$value, by=list(df$country,df$variable), FUN=sum)
df <- df %>%
rename(country = Group.1, sepcies = Group.2, population = x) # species is country*topic
df <- group_by(df, country)
df <- do(df, tidy(diversity(.$population)))
return(df)
}
# calculate diversity by country
general2 <- diversity_country(general)
specific2 <- diversity_country(specific)
View(specific2)
theme2 <- diversity_country(theme)
################### libraries #########################
library(dplyr)
library(vegan)
library(broom)
library(reshape2)
################### files #########################
general <- readRDS("./consolidated_results_NSF_general.Rds")
specific <- readRDS("./consolidated_results_NSF_specific.Rds")
theme <- readRDS("./consolidated_results_theme.Rds")
################### functions #########################
diversity_country <- function(df) {
df <- df %>%
select(-c("year"))
df <- melt(df,
id.vars = c("country"))
df <- aggregate(df$value, by=list(df$country,df$variable), FUN=sum)
df <- df %>%
rename(country = Group.1, sepcies = Group.2, population = x) # species is country*topic
df <- group_by(df, country)
df <- do(df, tidy(diversity(.$population)))
return(df)
}
remove_year_country <- function(df) {
df <- df %>%
select(-c("year","country"))
return(df)
}
diversity_LAC <- function(df) {
df <- colSums(df)
df <- diversity(df)
return(df)
}
################### libraries #########################
library(dplyr)
library(vegan)
library(broom)
library(reshape2)
################### files #########################
general <- readRDS("./consolidated_results_NSF_general.Rds")
specific <- readRDS("./consolidated_results_NSF_specific.Rds")
theme <- readRDS("./consolidated_results_theme.Rds")
################### functions #########################
diversity_country <- function(df) {
df <- df %>%
select(-c("year"))
df <- melt(df,
id.vars = c("country"))
df <- aggregate(df$value, by=list(df$country,df$variable), FUN=sum)
df <- df %>%
rename(country = Group.1, sepcies = Group.2, population = x) # species is country*topic
df <- group_by(df, country)
df <- do(df, tidy(diversity(.$population)))
return(df)
}
remove_year_country <- function(df) {
df <- df %>%
select(-c("year","country"))
return(df)
}
diversity_LAC <- function(df) {
df <- colSums(df)
df <- diversity(df)
return(df)
}
# calculate diversity by country
general2 <- diversity_country(general)
specific2 <- diversity_country(specific)
theme2 <- diversity_country(theme)
View(theme2)
cbind(general2, specific2)
diversity_by_country<-cbind(general2, specific2)
View(diversity_by_country)
diversity_by_country<-cbind(general2, specific2,theme2)
diversity_by_country <- diversity_by_country %>%
select(-c("country1","country2"))
diversity_by_country<-cbind(general2, specific2,theme2)
diversity_by_country <- diversity_by_country %>%
select(-c("country1","country2")) %>%
rename(NSFgeneral = x, NSFspecific = x1, theme = x2)
plot(diversity_by_country)
box(diversity_by_country)
boxplot(diversity_by_country)
library(ggpubr)
ggboxplot(diversity_by_country)
ggboxplot(diversity_by_country, x = "country")
diversity_by_country_graph <- melt(diversity_by_country,
id.vars = c("country"))
View(diversity_by_country_graph)
ggboxplot(diversity_by_country, x = "country")
ggboxplot(diversity_by_country, x = "country", y = "value", color = "variable")
ggboxplot(diversity_by_country_graph, x = "country", y = "value", color = "variable")
diversity.country.csv <- save(diversity_by_country)
fwrite(diversity_by_country, file = "diversity by country.csv")
library("data.table", lib.loc="/Library/Frameworks/R.framework/Versions/3.6/Resources/library")
library(data.table)
fwrite(diversity_by_country, file = "diversity by country.csv")
fwrite(diversity_by_country, file = "diversity by country.csv")
diversity_by_country_graph <- melt(diversity_by_country,
id.vars = c("country"))
ggboxplot(diversity_by_country_graph, x = "country", y = "value", color = "variable")
fwrite(diversity_by_country, file = "./diversity/diversity by country.csv")
ggboxplot(diversity_by_country_graph, y = "country", x= "value", color = "variable")
ggboxplot(diversity_by_country_graph, x = "country", y= "value", color = "variable")
View(diversity_by_country_graph)
theme_graph <- subset(diversity_by_country_graph, variable = "theme")
View(theme_graph)
theme_graph <- subset(diversity_by_country_graph, variable == "theme")
View(theme_graph)
ggboxplot(theme_graph, x = "country", y= "value", color = "variable")
ggboxplot(theme_graph, x = "country", y= "value", color = "variable") +
rotate_x_text()
# calculate diversity by paper / for all of LAC
clean <- remove_year_country(theme) #  specify which (species group)
diversity_paper <- diversity(clean)
diversity_LAC <- diversity_LAC(clean)
ggboxplot(theme_graph, x = "country", y= "value", color = "variable") +
rotate_x_text() +
hline(y = diversity_LAC)
ggdotchart(theme_graph, x = "country", y= "value", color = "variable") +
rotate_x_text() +
hline(y = diversity_LAC)
ggdotchart(theme_graph, x = "country", y= "value", color = "variable") +
rotate_x_text()
ggdotchart((theme_graph, x = "country", y= "value", color = "variable") +
rotate_x_text())
ggdotchart(theme_graph, x = "country", y= "value", color = "variable") +
rotate_x_text()
ggboxplot(theme_graph, x = "country", y= "value") +
rotate_x_text()
ggdotchart(theme_graph,
x = "country",
y = "value",
add = "segments")
ggdotchart(theme_graph,
x = "country",
y = "value",
add = "segments",
ggtheme = theme_pubr()    )
ggdotchart(theme_graph,
x = "country",
y = "value",
add = "segments",
rotate = "true")
ggdotchart(theme_graph,
x = "country",
y = "value",
add = "segments",
rotate = "true"),
# color = "cluster"
rotate_x_text() +
hline(y = diversity_LAC)
ggdotchart(theme_graph,
x = "country",
y = "value",
add = "segments",
rotate = "true"),
# color = "cluster"
rotate_x_text()
ggdotchart(theme_graph, x = "country", y = "value",
add = "segments",rotate = "true") +
rotate_x_text()
ggdotchart(theme_graph, x = "country", y = "value",
add = "segments",rotate = TRUE) +
rotate_x_text()
ggdotchart(theme_graph, x = "country", y = "value",
add = "segments",rotate = TRUE) + #add color = cluster
ggdotchart(theme_graph, x = "country", y = "value",
add = "segments",rotate = TRUE)  #add color = cluster
ggdotchart(theme_graph, x = "country", y = "value",
add = "segments", rotate = TRUE)  #add color = cluster
ggdotchart(theme_graph, x = "country", y = "value",
add = "segments", sorting = "descending", rotate = TRUE)  #add color = cluster
ggdotchart(theme_graph, x = "country", y = "value", #add color = cluster
add = "segments", sorting = "descending", rotate = TRUE) +
geom_hline(yintercept = diversity_LAC, linetype = 2, color = "lightgray")
ggdotchart(theme_graph, x = "country", y = "value", #add color = cluster
add = "segments", sorting = "descending", rotate = TRUE,
ylim = c(2, 4)) +
geom_hline(yintercept = diversity_LAC, linetype = 2, color = "lightgray") +
ggdotchart(theme_graph, x = "country", y = "value", #add color = cluster
add = "segments", sorting = "descending", rotate = TRUE,
ylim = c(2, 4)) +
geom_hline(yintercept = diversity_LAC, linetype = 2, color = "lightgray")
ggdotchart(theme_graph, x = "country", y = "value", #add color = cluster
add = "segments", sorting = "descending", rotate = TRUE) +
geom_hline(yintercept = diversity_LAC, linetype = 2, color = "lightgray")
theme_graph <- subset(diversity_by_country_graph, variable == "specific")
ggboxplot(theme_graph, x = "country", y= "value") +
rotate_x_text()
ggdotchart(theme_graph, x = "country", y = "value", #add color = cluster
add = "segments", sorting = "descending", rotate = TRUE) +
geom_hline(yintercept = diversity_LAC, linetype = 2, color = "lightgray")
theme_graph <- subset(diversity_by_country_graph, variable == "specific")
View(diversity_by_country_graph)
View(diversity_by_country_graph)
theme_graph <- subset(diversity_by_country_graph, variable == "NSFspecific")
ggboxplot(theme_graph, x = "country", y= "value") +
rotate_x_text()
ggdotchart(theme_graph, x = "country", y = "value", #add color = cluster
add = "segments", sorting = "descending", rotate = TRUE) +
geom_hline(yintercept = diversity_LAC, linetype = 2, color = "lightgray")
methods <- readRDS("./consolidated_results_methods.Rds")
budget <- readRDS("./consolidated_results_water budget.Rds")
budget<-subset(country == "Mexico")
View(budget)
budget<-subset(budget,country == "Mexico")
View(budget)
general <- subset(general,country == "Mexico")
specific <- subset(specific,country == "Mexico")
theme <- subset(theme,country == "Mexico")
methods <- subset(methods,country == "Mexico")
budget
View(general)
# analyze breakdown of methods and water budget
methods <- methods %>%
select(-c("year"))
methods <- readRDS("./consolidated_results_methods.Rds")
methods <- subset(methods,country == "Mexico")
# analyze breakdown of methods and water budget
methods <- methods %>%
select(-c("year"))
View(methods)
methods <- readRDS("./consolidated_results_methods.Rds")
methods <- subset(methods,country == "Mexico")
# analyze breakdown of methods and water budget
methods <- methods %>%
select(-c("year","country"))
methods <- colSums(methods)
methods <- as.data.frame(colSums(methods))
methods <- readRDS("./consolidated_results_methods.Rds")
methods <- subset(methods,country == "Mexico")
# analyze breakdown of methods and water budget
methods <- methods %>%
select(-c("year","country"))
methods <- as.data.frame(colSums(methods))
View(methods)
ggdotchart(methods, #add color = cluster
add = "segments", sorting = "descending", rotate = TRUE)
View(methods)
ggdotchart(methods, x = "colSums(methods)" #add color = cluster
add = "segments", sorting = "descending", rotate = TRUE)
View(methods)
plot(methods)
