################### libraries #########################
library(dplyr)
library(vegan)
library(broom)
library(reshape2)
library(ggpubr)
library(data.table)
library(wesanderson)
################### files #########################
general <- readRDS("./consolidated_results_NSF_general.Rds")
specific <- readRDS("./consolidated_results_NSF_specific.Rds")
theme <- readRDS("./consolidated_results_theme.Rds")
methods <- readRDS("./consolidated_results_methods.Rds")
budget <- readRDS("./consolidated_results_water budget.Rds")
################### functions #########################
remove_year_country <- function(df) {
df <- df %>%
filter(country != "Irrelevant") %>%
select(-c("year","country"))
return(df)
}
remove_year <- function(df) {
df <- df %>%
select(-c("year"))
return(df)
}
remove_country <- function(df) {
df <- df %>%
select(-c("country"))
return(df)
}
remove_irrelevant <- function(df) {
df <- df %>%
filter(country != "Irrelevant")
return(df)
}
diversity_country <- function(df) {
df <- df %>%
select(-c("year"))
df <- melt(df,
id.vars = c("country"))
df <- aggregate(df$value, by=list(df$country,df$variable), FUN=sum)
df <- df %>%
rename(country = Group.1, sepcies = Group.2, population = x) # species is country*topic
df <- group_by(df, country)
df <- do(df, tidy(diversity(.$population)))
return(df)
}
diversity_LAC <- function(df) {
df <- colSums(df)
df <- diversity(df)
return(df)
}
col_sums <- function(df) {
df <- colSums(df)
df$key=rownames(df)
return(sumdf)
}
general <- readRDS("./consolidated_results_NSF_general.Rds")
specific <- readRDS("./consolidated_results_NSF_specific.Rds")
theme <- readRDS("./consolidated_results_theme.Rds")
methods <- readRDS("./consolidated_results_methods.Rds")
budget <- readRDS("./consolidated_results_water budget.Rds")
general <- readRDS("./consolidated_results_NSF_general.Rds")
specific <- readRDS("./consolidated_results_NSF_specific.Rds")
theme <- readRDS("./consolidated_results_theme.Rds")
methods <- readRDS("./consolidated_results_methods.Rds")
budget <- readRDS("./consolidated_results_water budget.Rds")
setwd("~/R_code/LAC")
general <- readRDS("./consolidated_results_NSF_general.Rds")
specific <- readRDS("./consolidated_results_NSF_specific.Rds")
theme <- readRDS("./consolidated_results_theme.Rds")
methods <- readRDS("./consolidated_results_methods.Rds")
budget <- readRDS("./consolidated_results_water budget.Rds")
## define data frame
df <- remove_year(theme)
df <- remove_irrelevant(df)
df <- melt(df, id.vars = "country")
View(df)
## count # papers per country
sums <- aggregate(df$value, by=list(df$country,df$variable), FUN=sum)
names(sums) = c("country","topic","sum")
country_sums <- aggregate(sums$sum, by=list(sums$country), FUN=sum) # no. papers per country
names(country_sums) = c("country","no.papers")
remove <- as.data.frame(country_sums$country[country_sums$no.papers < 30]) # list countries w/ < 30 papers
keep <- as.data.frame(country_sums$country[country_sums$no.papers > 30])
## subset countries with > 30 papers
df<- subset(df, df$country %in% keep$`country_sums$country[country_sums$no.papers > 30]`)
sums <-aggregate(df$value, by=list(df$country,df$variable), FUN=sum)
names(sums) = c("country","topic","sum")
topic_sums <- aggregate(sums$sum, by=list(sums$topic), FUN=sum)
names(topic_sums) = c("topic","sum")
View(topic_sums)
## calculate country + topic sums
country_sums <- aggregate(sums$sum, by=list(sums$country), FUN=sum) # no. papers per country
names(country_sums) = c("country","no.papers")
View(country_sums)
# This might require
install.packages("webshot")
webshot::install_phantomjs()
install.packages("webshot")
# This might require
install.packages("webshot")
webshot::install_phantomjs()
library("DiagrammeR")
mermaid("
graph TD
J(1. data-driven literature review )
O(2. current research landscape)
J --- Q(topic modeling)
J --- R(location prediction)
J --- P(citation network)
O --- S(survey of researchers)
O --- T(country statistics)
Q --- F
R --- F
P --- F
S --- F
T --- F
F(Goal: Identify bright spots and blind spots of past water research in Latin America)
")
View(topic_sums)
library(dplyr)
library(reshape2)
library(ggpubr)
en <- read.csv("./data/topic_names_en.csv")
es <- read.csv("./data/topic_names_es.csv")
pt <- read.csv("./data/topic_names_pt.csv", na.strings=c("","NA"))
en$lang <- "en"
es$lang <- "es"
pt$lang <- "pt"
en2 <- melt(en,
id.vars = c("topic_id","lang"))
es2 <- melt(es,
id.vars = c("topic_id","lang"))
pt2 <- melt(pt,
id.vars = c("topic_id","lang"))
x <- rbind(en2,es2,pt2)
x2 <- x %>%
filter(variable == "NSF_specific") %>%
group_by(value, lang) %>%
tally
ggdotchart(x2, x = "value", y = "n",
color = "lang",
palette = c("#00AFBB", "#FC4E07",  "#E7B800"),
#group = "lang",
add = "segments",
add.params = list(color = "lightgray", size = 1),
rotate = TRUE)
ggbarplot(x2, x = "value", y = "n",
fill = "lang",
color = "white",
palette = c("#00AFBB", "#FC4E07",  "#E7B800"),
rotate = TRUE)
setwd("~/R_code/LAC/diversity")
en2 <- melt(en,
id.vars = c("topic_id","lang"))
library(dplyr)
library(reshape2)
library(ggpubr)
en <- read.csv("./data/topic_names_en.csv")
es <- read.csv("./data/topic_names_es.csv")
pt <- read.csv("./data/topic_names_pt.csv", na.strings=c("","NA"))
en$lang <- "en"
es$lang <- "es"
pt$lang <- "pt"
en2 <- melt(en,
id.vars = c("topic_id","lang"))
es2 <- melt(es,
id.vars = c("topic_id","lang"))
pt2 <- melt(pt,
id.vars = c("topic_id","lang"))
x <- rbind(en2,es2,pt2)
x2 <- x %>%
filter(variable == "NSF_specific") %>%
group_by(value, lang) %>%
tally
ggdotchart(x2, x = "value", y = "n",
color = "lang",
palette = c("#00AFBB", "#FC4E07",  "#E7B800"),
#group = "lang",
add = "segments",
add.params = list(color = "lightgray", size = 1),
rotate = TRUE)
ggbarplot(x2, x = "value", y = "n",
fill = "lang",
color = "white",
palette = c("#00AFBB", "#FC4E07",  "#E7B800"),
rotate = TRUE)
library(dplyr)
library(reshape2)
library(ggpubr)
en <- read.csv("./data/topic_names_en.csv")
setwd("~/R_code/LAC")
library(dplyr)
library(reshape2)
library(ggpubr)
en <- read.csv("./data/topic_names_en.csv")
es <- read.csv("./data/topic_names_es.csv")
pt <- read.csv("./data/topic_names_pt.csv", na.strings=c("","NA"))
en$lang <- "en"
es$lang <- "es"
pt$lang <- "pt"
en2 <- melt(en,
id.vars = c("topic_id","lang"))
es2 <- melt(es,
id.vars = c("topic_id","lang"))
pt2 <- melt(pt,
id.vars = c("topic_id","lang"))
x <- rbind(en2,es2,pt2)
x2 <- x %>%
filter(variable == "NSF_specific") %>%
group_by(value, lang) %>%
tally
ggdotchart(x2, x = "value", y = "n",
color = "lang",
palette = c("#00AFBB", "#FC4E07",  "#E7B800"),
#group = "lang",
add = "segments",
add.params = list(color = "lightgray", size = 1),
rotate = TRUE)
ggbarplot(x2, x = "value", y = "n",
fill = "lang",
color = "white",
palette = c("#00AFBB", "#FC4E07",  "#E7B800"),
rotate = TRUE)
setwd("~/R_code/LAC/diversity")
en <- read.csv("./topic_names_en.csv")
en <- read.csv("./topic_names_en.csv")
es <- read.csv("./topic_names_es.csv")
pt <- read.csv("./topic_names_pt.csv", na.strings=c("","NA"))
library(dplyr)
library(reshape2)
library(ggpubr)
en <- read.csv("./topic_names_en.csv")
es <- read.csv("./topic_names_es.csv")
pt <- read.csv("./topic_names_pt.csv", na.strings=c("","NA"))
en$lang <- "en"
es$lang <- "es"
pt$lang <- "pt"
en2 <- melt(en,
id.vars = c("topic_id","lang"))
es2 <- melt(es,
id.vars = c("topic_id","lang"))
pt2 <- melt(pt,
id.vars = c("topic_id","lang"))
x <- rbind(en2,es2,pt2)
x2 <- x %>%
filter(variable == "NSF_specific") %>%
group_by(value, lang) %>%
tally
ggdotchart(x2, x = "value", y = "n",
color = "lang",
palette = c("#00AFBB", "#FC4E07",  "#E7B800"),
#group = "lang",
add = "segments",
add.params = list(color = "lightgray", size = 1),
rotate = TRUE)
ggbarplot(x2, x = "value", y = "n",
fill = "lang",
color = "white",
palette = c("#00AFBB", "#FC4E07",  "#E7B800"),
rotate = TRUE)
ggdotchart(x2, x = "value", y = "n",
color = "lang",
palette = c("#00AFBB", "#FC4E07",  "#E7B800"),
#group = "lang",
add = "segments",
add.params = list(color = "lightgray", size = 1),
rotate = TRUE)
library(dplyr)
library(reshape2)
library(ggpubr)
en <- read.csv("./topic_names_en.csv")
es <- read.csv("./topic_names_es.csv")
pt <- read.csv("./topic_names_pt.csv", na.strings=c("","NA"))
en$lang <- "en"
es$lang <- "es"
pt$lang <- "pt"
en2 <- melt(en,
id.vars = c("topic_id","lang"))
es2 <- melt(es,
id.vars = c("topic_id","lang"))
pt2 <- melt(pt,
id.vars = c("topic_id","lang"))
x <- rbind(en2,es2,pt2)
x2 <- x %>%
filter(variable == "NSF_specific") %>%
group_by(value, lang) %>%
tally
ggdotchart(x2, x = "value", y = "n",
color = "lang",
palette = c("#00AFBB", "#FC4E07",  "#E7B800"),
#group = "lang",
add = "segments",
add.params = list(color = "lightgray", size = 1),
rotate = TRUE)
ggbarplot(x2, x = "value", y = "n",
fill = "lang",
color = "white",
palette = c("#00AFBB", "#FC4E07",  "#E7B800"),
rotate = TRUE)
View(x2)
source('~/R_code/LAC/diversity/compare_ldas.R')
ggdotchart(x2, x = "value", y = "n",
color = "lang",
palette = c("#00AFBB", "#FC4E07",  "#E7B800"),
#group = "lang",
add = "segments",
add.params = list(color = "lightgray", size = 1),
rotate = TRUE)
dev.off(())
dev.off()
dev.new()
library(dplyr)
library(reshape2)
library(ggpubr)
en <- read.csv("./topic_names_en.csv")
es <- read.csv("./topic_names_es.csv")
pt <- read.csv("./topic_names_pt.csv", na.strings=c("","NA"))
en$lang <- "en"
es$lang <- "es"
pt$lang <- "pt"
en2 <- melt(en,
id.vars = c("topic_id","lang"))
es2 <- melt(es,
id.vars = c("topic_id","lang"))
pt2 <- melt(pt,
id.vars = c("topic_id","lang"))
x <- rbind(en2,es2,pt2)
x2 <- x %>%
filter(variable == "NSF_specific") %>%
group_by(value, lang) %>%
tally
ggdotchart(x2, x = "value", y = "n",
color = "lang",
palette = c("#00AFBB", "#FC4E07",  "#E7B800"),
#group = "lang",
add = "segments",
add.params = list(color = "lightgray", size = 1),
rotate = TRUE)
ggbarplot(x2, x = "value", y = "n",
fill = "lang",
color = "white",
palette = c("#00AFBB", "#FC4E07",  "#E7B800"),
rotate = TRUE)
